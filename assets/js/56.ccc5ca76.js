(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{483:function(e,t,a){"use strict";a.r(t);var n=a(65),i=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"多人协作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多人协作"}},[e._v("#")]),e._v(" 多人协作")]),e._v(" "),a("p",[e._v("当你从远程仓库克隆时，实际上Git自动把本地的master分支和远程的master分支对应起来了，并且，远程仓库的默认名称是origin。")]),e._v(" "),a("p",[e._v("要查看远程库的信息，用git remote：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ git remote\norigin\n")])])]),a("p",[e._v("或者，用git remote -v显示更详细的信息：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ git remote -v\norigin  git@github.com:michaelliao/learngit.git (fetch)\norigin  git@github.com:michaelliao/learngit.git (push)\n")])])]),a("p",[e._v("上面显示了可以抓取和推送的origin的地址。如果没有推送权限，就看不到push的地址。")]),e._v(" "),a("p",[e._v("推送分支")]),e._v(" "),a("p",[e._v("推送分支，就是把该分支上的所有本地提交推送到远程库。推送时，要指定本地分支，这样，Git就会把该分支推送到远程库对应的远程分支上：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("git push origin master\n")])])]),a("p",[e._v("如果要推送其他分支，比如dev，就改成：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("git push origin dev\n")])])]),a("h3",{attrs:{id:"抓取分支"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#抓取分支"}},[e._v("#")]),e._v(" 抓取分支")]),e._v(" "),a("p",[e._v("多人协作时，大家会往"),a("code",[e._v("matser")]),e._v("和"),a("code",[e._v("dev")]),e._v("分支上推送各自的修改。")]),e._v(" "),a("p",[e._v("现在，模拟一个你的小伙伴，可以在另一台电脑（注意要把SSH Key添加到GitHub）或者同一台电脑的另一个目录下克隆：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ git clone git@github.com:michaelliao/learngit.git\nCloning into 'learngit'...\nremote: Counting objects: 40, done.\nremote: Compressing objects: 100% (21/21), done.\nremote: Total 40 (delta 14), reused 40 (delta 14), pack-reused 0\nReceiving objects: 100% (40/40), done.\nResolving deltas: 100% (14/14), done.\n")])])]),a("p",[e._v("当你的小伙伴从远程库clone时，默认情况下，你的小伙伴只能看到本地的master分支。不信可以用git branch命令看看：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ git branch\n* master\n")])])]),a("p",[e._v("现在，你的小伙伴要在dev分支上开发，就必须创建远程origin的dev分支到本地，于是他用这个命令创建本地dev分支：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("git checkout -b dev origin/dev\n")])])]),a("p",[e._v("现在，他就可以在dev上继续修改，然后，时不时地把dev分支push到远程：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$ git add env.txt\n\n$ git commit -m "add env"\n[dev 7a5e5dd] add env\n 1 file changed, 1 insertion(+)\n create mode 100644 env.txt\n\n$ git push origin dev\nCounting objects: 3, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (2/2), done.\nWriting objects: 100% (3/3), 308 bytes | 308.00 KiB/s, done.\nTotal 3 (delta 0), reused 0 (delta 0)\nTo github.com:michaelliao/learngit.git\n   f52c633..7a5e5dd  dev -> dev\n')])])]),a("p",[e._v("你的小伙伴已经向origin/dev分支推送了他的提交，而碰巧你也对同样的文件作了修改，并试图推送：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ cat env.txt\nenv\n\n$ git add env.txt\n\n$ git commit -m \"add new env\"\n[dev 7bd91f1] add new env\n 1 file changed, 1 insertion(+)\n create mode 100644 env.txt\n\n$ git push origin dev\nTo github.com:michaelliao/learngit.git\n ! [rejected]        dev -> dev (non-fast-forward)\nerror: failed to push some refs to 'git@github.com:michaelliao/learngit.git'\nhint: Updates were rejected because the tip of your current branch is behind\nhint: its remote counterpart. Integrate the remote changes (e.g.\nhint: 'git pull ...') before pushing again.\nhint: See the 'Note about fast-forwards' in 'git push --help' for details.\n")])])]),a("p",[e._v("推送失败，因为你的小伙伴的最新提交和你试图推送的提交有冲突，解决办法也很简单，Git已经提示我们，先用git pull把最新的提交从origin/dev抓下来，然后，在本地合并，解决冲突，再推送：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ git pull\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull <remote> <branch>\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/<branch> dev\n")])])]),a("p",[e._v("git pull也失败了，原因是没有指定本地dev分支与远程origin/dev分支的链接，根据提示，设置dev和origin/dev的链接：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ git branch --set-upstream-to=origin/dev dev\nBranch 'dev' set up to track remote branch 'dev' from 'origin'.\n")])])]),a("p",[e._v("再pull：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ git pull\nAuto-merging env.txt\nCONFLICT (add/add): Merge conflict in env.txt\nAutomatic merge failed; fix conflicts and then commit the result.\n")])])]),a("p",[e._v("这回git pull成功，但是合并有冲突，需要手动解决，解决的方法和分支管理中的解决冲突完全一样。解决后，提交，再push：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$ git commit -m "fix env conflict"\n[dev 57c53ab] fix env conflict\n\n$ git push origin dev\nCounting objects: 6, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (4/4), done.\nWriting objects: 100% (6/6), 621 bytes | 621.00 KiB/s, done.\nTotal 6 (delta 0), reused 0 (delta 0)\nTo github.com:michaelliao/learngit.git\n   7a5e5dd..57c53ab  dev -> dev\n')])])]),a("p",[e._v("因此，多人协作的工作模式通常是这样：")]),e._v(" "),a("ol",[a("li",[e._v("首先，可以试图用"),a("code",[e._v("git push origin <branch-name>")]),e._v("推送自己的修改；")]),e._v(" "),a("li",[e._v("如果推送失败，则因为远程分支比你的本地更新，需要先用"),a("code",[e._v("git pull")]),e._v("试图合并；")]),e._v(" "),a("li",[e._v("如果合并有冲突，则解决冲突，并在本地提交；")]),e._v(" "),a("li",[e._v("没有冲突或者解决掉冲突后，再用"),a("code",[e._v("git push origin <branch-name>")]),e._v("推送就能成功！")])]),e._v(" "),a("p",[e._v("如果"),a("code",[e._v("git pull")]),e._v("提示"),a("code",[e._v("no tracking information")]),e._v("，则说明本地分支和远程分支的链接关系没有创建，用命令"),a("code",[e._v("git branch --set-upstream-to <branch-name> origin/<branch-name>")]),e._v("。")]),e._v(" "),a("h3",{attrs:{id:"小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[e._v("#")]),e._v(" 小结")]),e._v(" "),a("ul",[a("li",[e._v("查看远程库信息，使用"),a("code",[e._v("git remote -v")]),e._v(";")]),e._v(" "),a("li",[e._v("本地创建的新分支，如果不推送到远程，别人是无法看见的；")]),e._v(" "),a("li",[e._v("从本地推送分支，使用"),a("code",[e._v("git push origin branch-name")]),e._v(",如果推送失败，先用"),a("code",[e._v("git pull")]),e._v("抓取远程的提交；")]),e._v(" "),a("li",[e._v("从本地创建和远程分支对应的分支，使用"),a("code",[e._v("git checkout -b branch-name origin/branch-name")]),e._v("，本地和远程分支名称最好保持一致。")]),e._v(" "),a("li",[e._v("建立本地分支和远程分支的关联，使用"),a("code",[e._v("git branch --set-upstream branch-name origin/branch-name")]),e._v(";")]),e._v(" "),a("li",[e._v("从远程抓取分支，使用"),a("code",[e._v("git pull")]),e._v(",如果有冲突，要先处理冲突；")])]),e._v(" "),a("p",[e._v("下一节"),a("RouterLink",{attrs:{to:"/pages/git/test19.html"}},[e._v("Rebase")])],1)])}),[],!1,null,null,null);t.default=i.exports}}]);